# 概率论与数理统计 - 数值模拟实验项目

> **一个高质量、专业化的概率统计数值模拟实验框架**  
> 包含6个核心知识点的深度实验，生成科研级可视化图表

---

## 📋 项目简介

本项目实现了概率论与数理统计课程中的6个重要知识点的数值模拟实验，每个实验都包含完整的理论分析、算法实现和可视化展示。项目采用现代化的Python科学计算栈，生成高质量的实验结果和图表。


运行方法：
pip install -r requirements.txt
python main.py


### ✨ 核心特性

- 🎯 **6大核心实验**：覆盖从随机数生成到高级统计推断的完整链条
- 📊 **专业可视化**：每个实验生成2-4张高质量科研级图表
- 🔬 **严谨实现**：基于统计学理论的正确实现，包含详细的数值验证
- 🚀 **易于使用**：一键运行所有实验，自动生成结果
- 📈 **丰富输出**：控制台输出详细的数值结果，图片保存至results目录

---

## 🧪 实验内容

### 实验一：Box-Muller变换 - 从均匀分布生成正态分布

**知识点：** 均匀分布在统计计算中的特殊地位

**核心原理：**
```
利用两个独立的U(0,1)均匀分布随机变量：
  Z₁ = √(-2ln(U₁)) × cos(2πU₂)
  Z₂ = √(-2ln(U₁)) × sin(2πU₂)
生成两个独立的标准正态分布随机变量
```

**实验内容：**
- Box-Muller变换的详细过程可视化（极坐标变换）
- 生成的正态分布与理论分布的拟合检验（K-S检验）
- 自定义参数（μ, σ²）正态分布的生成
- Q-Q图检验、累积分布函数对比、核密度估计

**输出图表：**
- `exp1_box_muller_transform.png` - 完整变换过程（6子图）
- `exp1_custom_normal.png` - 自定义参数正态分布分析（4子图）

---

### 实验二：中心极限定理的数值验证

**知识点：** 中心极限定理 (Central Limit Theorem)

**核心原理：**
```
设X₁, X₂, ..., Xₙ是独立同分布的随机变量，
期望为μ，方差为σ²，则当n足够大时：
  (X̄ - μ) / (σ/√n) → N(0,1)
```

**实验内容：**
- 4种不同原始分布的CLT验证（均匀、指数、卡方、泊松）
- 不同样本量（n=5, 10, 30, 50）下的收敛效果
- K-S检验量化正态性
- Q-Q图矩阵展示
- 收敛速度分析（K-S统计量随样本量的变化）

**输出图表：**
- `exp2_clt_comparison.png` - 4×4矩阵对比图
- `exp2_qq_plots.png` - Q-Q图矩阵
- `exp2_convergence_rate.png` - 收敛速度分析

---

### 实验三：参数估计方法对比研究

**知识点：** 极大似然估计(MLE) vs 矩估计(MME)

**核心原理：**
```
矩估计(MME): 用样本矩估计总体矩
极大似然估计(MLE): 最大化似然函数 L(θ|x) = ∏f(xᵢ|θ)
```

**实验内容：**
- 正态分布：μ和σ的MLE vs MME对比
- 指数分布：λ参数估计
- 伽玛分布：α和β的数值优化估计
- 贝塔分布：复杂参数的估计
- 偏差(Bias)和均方误差(MSE)分析
- 估计量分布的可视化

**输出图表：**
- `exp3_normal_estimation.png` - 正态分布参数估计对比
- `exp3_exponential_estimation.png` - 指数分布参数估计
- `exp3_mse_comparison.png` - MSE随样本量变化（对数尺度）

---

### 实验四：假设检验的功效分析

**知识点：** 假设检验、第一类/第二类错误、检验功效

**核心原理：**
```
第一类错误α: 拒绝真的H₀的概率（显著性水平）
第二类错误β: 接受假的H₀的概率
检验功效Power = 1 - β
```

**实验内容：**
- 单样本t检验：功效随效应量和样本量的变化
- 双样本t检验：功效曲线和热力图
- K-S检验：检测分布差异的功效
- 卡方拟合优度检验：检测概率偏离的功效
- 两类错误的可视化展示

**输出图表：**
- `exp4_one_sample_t_power.png` - 单样本t检验功效曲线
- `exp4_two_sample_t_power.png` - 双样本t检验（功效曲线+热力图）
- `exp4_ks_test_power.png` - K-S检验功效分析
- `exp4_chi2_test_power.png` - 卡方检验功效（含概率分布示例）
- `exp4_type_errors.png` - 两类错误可视化（4子图）

---

### 实验五：蒙特卡洛方法

**知识点：** 蒙特卡洛模拟在统计计算和积分估计中的应用

**核心原理：**
```
利用随机抽样估计确定性问题
π估计: A_circle/A_square ≈ 4 × (n_inside/n_total)
积分估计: ∫ₐᵇf(x)dx ≈ (b-a)/n × Σf(Xᵢ)
```

**实验内容：**
- π值估计（投点法）+ 收敛性分析
- 定积分估计（4个测试函数：x², sin(x), e^(-x²), 1/(1+x²)）
- 误差收敛率验证（理论O(1/√n)）
- 置信区间覆盖率的蒙特卡洛验证
- 金融应用：Black-Scholes期权定价

**输出图表：**
- `exp5_pi_convergence.png` - π估计收敛分析
- `exp5_pi_visualization.png` - 投点可视化（4个样本量）
- `exp5_integral_functions.png` - 4个积分函数可视化
- `exp5_integral_convergence.png` - 积分估计误差收敛
- `exp5_confidence_interval.png` - 置信区间验证（4子图）
- `exp5_option_pricing.png` - 期权定价模拟（股价路径+收益分布）

---

### 实验六：Bootstrap方法及其应用

**知识点：** Bootstrap重抽样方法（非参数统计推断）

**核心原理：**
```
从原始样本中有放回地抽样，生成Bootstrap样本
利用Bootstrap样本估计统计量的分布、置信区间等
不依赖于总体分布的参数假设
```

**实验内容：**
- Bootstrap置信区间（均值、中位数、标准差、偏度）
- Bootstrap偏差校正
- Bootstrap标准误估计（与理论值对比）
- Bootstrap假设检验（排列检验）
- 混合分布下的多种统计量分析

**输出图表：**
- `exp6_bootstrap_ci.png` - Bootstrap置信区间（4种统计量）
- `exp6_original_data.png` - 原始数据分布分析
- `exp6_bias_correction.png` - 偏差校正可视化
- `exp6_standard_error.png` - 标准误对比和收敛分析
- `exp6_hypothesis_test.png` - Bootstrap假设检验（4子图）
- `exp6_various_statistics.png` - 多种统计量的Bootstrap分析

---

## 🚀 快速开始

### 环境要求

- Python 3.8+
- 依赖包见 `requirements.txt`

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行实验

**方式一：运行所有实验**
```bash
python main.py
```

**方式二：运行并保存文本结果**
```bash
python save_results.py
```
这会生成：
- `results/实验结果汇总.txt` - 所有实验的完整文本输出
- `results/实验一_Box-Muller变换_输出.txt` - 单个实验的详细输出
- ... 每个实验都有单独的文本文件

**方式三：运行单个实验**
```bash
python main.py 1    # 运行实验一
python main.py 2    # 运行实验二
# ... 以此类推
```

**方式四：直接运行某个实验脚本**
```bash
python experiment_1_box_muller.py
python experiment_2_clt.py
# ... 以此类推
```

**💡 推荐写报告时使用方式二**，可以获得完整的数值结果文本文件！

---

## 📁 项目结构

```
gaitong-bighomework/
│
├── main.py                              # 主运行脚本
├── save_results.py                      # 保存文本结果脚本（推荐！）
├── utils.py                             # 工具函数（绘图配置、文件管理）
├── requirements.txt                     # 依赖包列表
│
├── experiment_1_box_muller.py           # 实验一：Box-Muller变换
├── experiment_2_clt.py                  # 实验二：中心极限定理
├── experiment_3_parameter_estimation.py # 实验三：参数估计
├── experiment_4_hypothesis_testing.py   # 实验四：假设检验
├── experiment_5_monte_carlo.py          # 实验五：蒙特卡洛方法
├── experiment_6_bootstrap.py            # 实验六：Bootstrap方法
│
├── results/                             # 结果输出目录（自动创建）
│   ├── exp1_*.png                       # 实验一的图表
│   ├── exp2_*.png                       # 实验二的图表
│   ├── ...                              # 其他实验图表
│   ├── 实验结果汇总.txt                  # 所有实验的文本输出汇总
│   ├── 实验一_Box-Muller变换_输出.txt   # 实验一详细文本输出
│   └── ...                              # 其他实验的文本输出
│
└── README.md                            # 本文件
```

---

## 📊 输出说明

### 控制台输出

每个实验运行时会在控制台输出：
- 实验进度信息
- 关键数值结果（统计量、p值、误差等）
- 格式化的表格数据
- 运行时间统计

### 图片输出

所有图片保存在 `results/` 目录下：
- 分辨率：300 DPI（高质量，适合报告）
- 格式：PNG
- 命名：`exp[实验编号]_[描述].png`
- 总计：约18-20张专业图表

### 📝 文本结果输出（新增！）

使用 `python save_results.py` 运行后，会在 `results/` 目录生成：

**汇总文件：**
- `实验结果汇总.txt` - 包含所有6个实验的完整输出（推荐！）

**单独文件：**
- `实验一_Box-Muller变换_输出.txt`
- `实验二_中心极限定理验证_输出.txt`
- `实验三_参数估计方法对比_输出.txt`
- `实验四_假设检验功效分析_输出.txt`
- `实验五_蒙特卡洛方法_输出.txt`
- `实验六_Bootstrap方法_输出.txt`

每个文本文件包含：
- ✅ 所有数值计算结果
- ✅ 统计检验的p值
- ✅ 参数估计值和误差
- ✅ 格式化的表格数据
- ✅ 完整的实验流程说明

**💡 写报告时直接从这些文本文件复制数据即可！**

---

## 🔧 技术栈

| 技术 | 用途 |
|------|------|
| **NumPy** | 数值计算和随机数生成 |
| **SciPy** | 统计分布、假设检验、优化算法 |
| **Matplotlib** | 基础绘图 |
| **Seaborn** | 高级统计图表 |
| **Pandas** | 数据处理（部分实验） |
| **tqdm** | 进度条显示 |

---

## 📈 实验流程

### 典型实验流程

```
1. 理论介绍
   ↓
2. 数据生成/模拟
   ↓
3. 算法实现
   ↓
4. 数值计算
   ↓
5. 统计检验
   ↓
6. 可视化展示
   ↓
7. 结果输出
```

### 每个实验包含

1. **理论原理**：数学公式和统计学基础
2. **算法实现**：Python类和函数的专业实现
3. **数值模拟**：大规模Monte Carlo模拟（通常≥1000次）
4. **统计检验**：K-S检验、t检验、卡方检验等
5. **可视化**：多子图、多角度的专业图表
6. **结果分析**：数值结果的表格化输出

---

## 🎨 图表特色

### 专业化设计

- ✅ 清晰的标题和标签（中文+数学符号）
- ✅ 图例和注释完整
- ✅ 网格线提升可读性
- ✅ 颜色搭配专业（使用色盲友好配色）
- ✅ 子图布局合理
- ✅ 高分辨率输出（300 DPI）

### 图表类型

- 直方图（Histogram）+ 理论密度曲线
- Q-Q图（Quantile-Quantile Plot）
- 散点图（Scatter Plot）
- 箱线图（Box Plot）
- 热力图（Heatmap）
- 功效曲线（Power Curve）
- 收敛曲线（Convergence Plot）
- 置信区间可视化

---

## ⏱️ 运行时间

| 实验 | 预计时间 |
|------|---------|
| 实验一 | ~10秒 |
| 实验二 | ~30秒 |
| 实验三 | ~60秒 |
| 实验四 | ~45秒 |
| 实验五 | ~40秒 |
| 实验六 | ~30秒 |
| **总计** | **~3-4分钟** |

*时间会因计算机性能而异*

---

## 💡 使用建议

### 撰写报告时（重要！）

**步骤1：生成完整结果**
```bash
python save_results.py
```

**步骤2：获取数据**
- 📊 **图表**：从 `results/` 文件夹直接插入PNG图片
- 📝 **数据**：打开 `results/实验结果汇总.txt`，复制需要的数值
- 🔬 **原理**：查看各实验脚本开头的理论说明
- 💻 **代码**：直接复制实验脚本作为附录

**步骤3：报告结构建议**
```
第X节 实验X：标题
├── X.1 实验原理（从脚本开头复制理论说明）
├── X.2 实验方法（简述算法流程）
├── X.3 实验结果
│   ├── 数值结果（从txt文件复制表格）
│   └── 可视化结果（插入PNG图片）
└── X.4 结果分析（基于数据进行分析）
附录：代码实现（复制.py文件）
```

**文本结果示例：**
打开 `results/实验结果汇总.txt` 可以看到：
```
======================================================================
实验一：Box-Muller变换生成正态分布
======================================================================

步骤1：生成标准正态分布 N(0,1)
----------------------------------------------------------------------
  Z1 K-S检验统计量: 0.008234
  Z1 p值: 0.234567
  Z2 K-S检验统计量: 0.007891
  Z2 p值: 0.289012
...
```
直接复制到Word/LaTeX即可！

### 代码学习

- 每个实验脚本都有详细注释
- 函数和类的文档字符串完整
- 代码结构清晰，易于理解和修改
- 采用面向对象设计，便于扩展

### 扩展实验

可以轻松添加新实验：
1. 创建新的实验脚本（参照现有格式）
2. 在 `main.py` 中注册新实验
3. 运行并生成结果

---

## 🎓 知识点覆盖

本项目覆盖的主要知识点：

- [x] 随机数生成（Box-Muller变换）
- [x] 中心极限定理
- [x] 大数定律（隐含）
- [x] 参数估计（MLE、MME）
- [x] 假设检验（t检验、K-S检验、卡方检验）
- [x] 检验功效分析
- [x] 蒙特卡洛模拟
- [x] Bootstrap方法
- [x] 置信区间
- [x] 偏差-方差分析
- [x] 收敛性分析

---

## 📝 注意事项

1. **中文字体**：如果图表中文显示有问题，请确保系统安装了SimHei字体，或修改 `utils.py` 中的字体配置
2. **随机种子**：所有实验都设置了随机种子（seed=42），确保结果可重复
3. **计算时间**：实验三和四涉及大量数值优化，可能耗时较长
4. **内存使用**：蒙特卡洛模拟会占用一定内存，建议至少4GB可用内存

---

## 🔍 故障排查

### 图表中文显示乱码

**解决方案：**
修改 `utils.py` 中的字体配置：
```python
plt.rcParams['font.sans-serif'] = ['Microsoft YaHei', 'SimHei', 'DejaVu Sans']
```

### 运行速度慢

**解决方案：**
- 减少实验脚本中的 `n_simulations` 或 `n_bootstrap` 参数
- 关闭其他占用CPU的程序

### 依赖包安装失败

**解决方案：**
```bash
pip install --upgrade pip
pip install -r requirements.txt --no-cache-dir
```